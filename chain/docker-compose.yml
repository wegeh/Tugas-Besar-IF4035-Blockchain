services:
  geth:
    image: ethereum/client-go:v1.13.15
    container_name: poa-geth
    volumes:
      - ./:/data
    ports:
      - "8545:8545"
      - "30303:30303"
    command: >
      --datadir /data/geth-data
      --networkid 1515
      --http --http.addr 0.0.0.0 --http.port 8545
      --http.api eth,net,web3,personal,clique
      --http.corsdomain="*"
      --http.vhosts="*"
      --allow-insecure-unlock
      --unlock "0x741d8f09f3Df0C70e42f1A00E8c29e130167f785,0xBce8e0EE8a0ebc0c0B988fB80C415f746D5548a6"
      --password /data/password.txt
      --miner.etherbase "0x741d8f09f3Df0C70e42f1A00E8c29e130167f785"
      --mine
      --syncmode full
      --ipcdisable
      --verbosity 3

  ipfs:
    image: ipfs/kubo:latest
    container_name: carbon-ipfs
    ports:
      - "5001:5001"   # API
      - "8080:8080"   # Gateway
    volumes:
      - ./ipfs_data:/data/ipfs
    environment:
      - IPFS_PROFILE=server
    command: ["daemon", "--offline"]
    restart: unless-stopped
